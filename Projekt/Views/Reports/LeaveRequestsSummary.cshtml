@model IEnumerable<Projekt.Models.LeaveRequest>
@{
    ViewData["Title"] = "Leave Requests Summary";
    var year = ViewBag.Year as int? ?? DateTime.Now.Year;
}

<div class="neo-card" style="margin-bottom: 2rem;">
    <h1 style="font-size: 2.5rem; font-weight: 900; text-transform: uppercase; margin-bottom: 2rem;">
        <i class="bi bi-calendar-check"></i> Leave Requests Summary
    </h1>

    <form method="get" class="neo-card" style="background: var(--neo-pink); margin-bottom: 2rem;">
        <div style="display: grid; grid-template-columns: 1fr auto; gap: 1rem; align-items: end;">
            <div class="neo-form-group" style="margin: 0;">
                <label class="neo-form-label">Year</label>
                <select name="year" class="neo-input">
                    @for (int y = DateTime.Now.Year + 1; y >= DateTime.Now.Year - 5; y--)
                    {
                        <option value="@y" selected="@(y == year)">@y</option>
                    }
                </select>
            </div>
            <button type="submit" class="neo-btn neo-btn-success">
                <i class="bi bi-search"></i> Filter
            </button>
        </div>
    </form>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
        <div class="neo-card" style="background: var(--neo-yellow); text-align: center;">
            <p style="font-size: 3rem; font-weight: 900; margin: 0;">@Model.Count()</p>
            <p style="font-weight: 900; text-transform: uppercase; margin: 0;">Total Requests</p>
        </div>
        <div class="neo-card" style="background: var(--neo-blue); text-align: center;">
            <p style="font-size: 3rem; font-weight: 900; margin: 0;">@Model.Count(lr => lr.Status == Projekt.Models.LeaveRequestStatus.Pending)</p>
            <p style="font-weight: 900; text-transform: uppercase; margin: 0;">Pending</p>
        </div>
        <div class="neo-card" style="background: var(--neo-green); text-align: center;">
            <p style="font-size: 3rem; font-weight: 900; margin: 0;">@Model.Count(lr => lr.Status == Projekt.Models.LeaveRequestStatus.Approved)</p>
            <p style="font-weight: 900; text-transform: uppercase; margin: 0;">Approved</p>
        </div>
        <div class="neo-card" style="background: var(--neo-red); text-align: center; color: var(--neo-white);">
            <p style="font-size: 3rem; font-weight: 900; margin: 0;">@Model.Count(lr => lr.Status == Projekt.Models.LeaveRequestStatus.Rejected)</p>
            <p style="font-weight: 900; text-transform: uppercase; margin: 0;">Rejected</p>
        </div>
    </div>

    <div style="overflow-x: auto;">
        <table class="neo-table">
            <thead>
                <tr>
                    <th>Employee</th>
                    <th>Leave Type</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Days</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var request in Model.OrderBy(lr => lr.StartDate))
                {
                    <tr>
                        <td style="font-weight: 700;">@request.Employee.FirstName @request.Employee.LastName</td>
                        <td>@request.LeaveType</td>
                        <td>@request.StartDate.ToString("yyyy-MM-dd")</td>
                        <td>@request.EndDate.ToString("yyyy-MM-dd")</td>
                        <td style="font-weight: 900;">@((request.EndDate - request.StartDate).Days + 1)</td>
                        <td>
                            @if (request.Status == Projekt.Models.LeaveRequestStatus.Pending)
                            {
                                <span class="neo-badge" style="background: var(--neo-yellow);">Pending</span>
                            }
                            else if (request.Status == Projekt.Models.LeaveRequestStatus.Approved)
                            {
                                <span class="neo-badge neo-badge-user">Approved</span>
                            }
                            else
                            {
                                <span class="neo-badge neo-badge-admin">Rejected</span>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <div style="margin-top: 2rem;">
        <a asp-action="Index" class="neo-btn" style="background: var(--neo-white);">
            <i class="bi bi-arrow-left"></i> Back to Reports
        </a>
    </div>
</div>
