@model IEnumerable<Projekt.Models.Project>
@{
    ViewData["Title"] = "Projects Summary";
}

<div class="neo-card" style="margin-bottom: 2rem;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h1 style="font-size: 2.5rem; font-weight: 900; text-transform: uppercase; margin: 0;">
            <i class="bi bi-kanban"></i> Projects Summary
        </h1>
        <a asp-action="Index" class="neo-btn" style="background: var(--neo-white);">
            <i class="bi bi-arrow-left"></i> Back
        </a>
    </div>

    <div style="background: var(--neo-purple); padding: 2rem; border: 4px solid var(--neo-black); box-shadow: 4px 4px 0px var(--neo-black); margin-bottom: 2rem;">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; text-align: center;">
            <div>
                <p style="font-size: 3rem; font-weight: 900; margin: 0;">@Model.Count()</p>
                <p style="font-weight: 900; text-transform: uppercase; margin: 0;">Total Projects</p>
            </div>
            <div>
                <p style="font-size: 3rem; font-weight: 900; margin: 0;">@Model.Count(p => !p.EndDate.HasValue || p.EndDate > DateTime.Now)</p>
                <p style="font-weight: 900; text-transform: uppercase; margin: 0;">Active Projects</p>
            </div>
            <div>
                <p style="font-size: 3rem; font-weight: 900; margin: 0;">@Model.Sum(p => p.EmployeeProjects.Count)</p>
                <p style="font-weight: 900; text-transform: uppercase; margin: 0;">Total Assignments</p>
            </div>
        </div>
    </div>

    @foreach (var project in Model)
    {
        <div class="neo-card neo-hover-lift" style="background: var(--neo-blue); margin-bottom: 1.5rem;">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem; flex-wrap: wrap; gap: 1rem;">
                <div>
                    <h2 style="font-size: 1.5rem; font-weight: 900; text-transform: uppercase; margin-bottom: 0.5rem;">
                        <i class="bi bi-folder-fill"></i> @project.Name
                    </h2>
                    <p style="font-weight: 700; margin: 0;">@(project.Description ?? "No description")</p>
                </div>
                <span class="neo-badge neo-badge-user" style="font-size: 1rem; padding: 0.5rem 1rem;">
                    <i class="bi bi-people-fill"></i> @project.EmployeeProjects.Count Team Members
                </span>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <div>
                    <p style="font-weight: 700; margin: 0;"><strong>Start:</strong> @project.StartDate.ToString("yyyy-MM-dd")</p>
                </div>
                <div>
                    <p style="font-weight: 700; margin: 0;">
                        <strong>End:</strong> 
                        @if (project.EndDate.HasValue)
                        {
                            @project.EndDate.Value.ToString("yyyy-MM-dd")
                        }
                        else
                        {
                            <span class="neo-badge" style="background: var(--neo-green);">Ongoing</span>
                        }
                    </p>
                </div>
            </div>

            @if (project.EmployeeProjects.Any())
            {
                <div style="margin-top: 1rem; padding-top: 1rem; border-top: 3px solid var(--neo-black);">
                    <p style="font-weight: 900; margin-bottom: 0.5rem;">Team:</p>
                    <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                        @foreach (var ep in project.EmployeeProjects)
                        {
                            <span class="neo-badge" style="background: var(--neo-white);">
                                <i class="bi bi-person"></i> @ep.Employee.FirstName @ep.Employee.LastName
                            </span>
                        }
                    </div>
                </div>
            }
        </div>
    }
</div>
